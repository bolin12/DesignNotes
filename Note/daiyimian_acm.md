

## 戴一面ACM
https://arxiv.org/abs/2009.14530

红外小目标检测是早期预警系统、精确制导武器和海上监视系统等应用的关键技术。在许多情况下，静态背景的传统假设并不适用 [17]。因此，研究人员最近开始更加关注单帧检测问题[10]。信号处理界普遍的想法是直接建立模型来测量红外小目标与其邻域上下文之间的对比度[2, 10]。通过在最终显着图上应用阈值，然后分割出潜在目标。尽管无需学习且计算友好，但这些模型驱动的方法仍存在以下缺点：

1、具有全局唯一显着性、稀疏性或高对比度的目标假设在现实世界的图像中并不成立。真实昏暗的目标可能不显眼且对比度低，而许多背景干扰物满足这些假设，导致许多误报
2、许多超参数，例如 [10] 中的 λ 和 [4] 中的 h，对图像内容敏感且高度相关，对于高度可变的场景不够鲁棒
简而言之，这些方法是有缺陷的，因为它们缺乏对整体场景的高级理解，使得它们无法检测到极端暗淡的场景并消除显着的干扰。因此，有必要将高级上下文语义嵌入到模型中以更好地检测

众所周知，深度网络可以提供高级语义特征[12]，而注意力模块可以通过捕获远程上下文交互来进一步提高 CNN 的表示能力 [9]。然而，尽管卷积神经网络在目标检测和分割方面取得了巨大成功[36]，但在红外小目标检测领域研究的深度学习方法却很少。我们认为主要原因如下：
1. 迄今为止缺乏公共数据集。深度学习需要大量数据。然而，到目前为止，还没有用于单帧检测场景的具有高质量注释的公共红外小目标数据集，可以在其上训练、测试和比较各种新方法。
2. 最少的内在信息。 SPIE 将红外小目标定义为 256 ×256 图像的总空间范围小于 80 像素（9 ×9）[34]。缺乏纹理或形状特征使得纯粹以目标为中心的表示不足以进行可靠的检测。特别是在深度网络中，小目标很容易被复杂的环境淹没。 
3. 解析与语义的矛盾。红外小目标通常被淹没在低信噪比的复杂背景中。对于网络而言，检测这些具有低误报的昏暗目标既需要对整个红外图像的高级语义理解，又需要精细分辨率的预测图，这是深度网络的内生矛盾，因为它们学习更多的语义表示通过逐渐衰减特征尺寸

此外，这些最先进的网络是为通用图像数据集设计的 [15, 19]。由于数据分布的巨大差异，直接将它们用于红外小目标检测可能会导致灾难性的失败。它需要在多个方面重新定制网络，包括

1. 重新定制下采样方案：许多研究强调，在设计 CNN 时，预测器的感受野应与对象尺度范围相匹配 [29, 20]。如果不重新定制下采样方案，随着网络的深入，红外小目标的特征几乎无法保留。 
2.  重新定制注意力模块：现有的注意力模块倾向于聚合全局或远程上下文 [15, 9]。基本假设是对象相对较大且分布更广泛，这与 ImageNet [30] 中的对象一致。然而，红外小目标并非如此，全局注意力模块会削弱它们的特性。这就产生了什么样的注意力模块适合突出红外小目标的问题。 
3.  重新定制特征融合方法：最近的作品以单向、自上而下的方式融合跨层特征[18, 32]，旨在基于高层语义选择正确的低层特征。然而，由于小目标可能已经被深层背景淹没，纯粹的自上而下调制可能不起作用，甚至有害


为了支持数据驱动的方法，我们首先贡献了一个开放数据集来推进单帧红外小目标检测的研究，称为 SIRST。从数百个红外小目标序列中选择代表帧，并手动标记为五种注释形式，从而可以训练各种机器学习方法。据我们所知，SIRST 不仅是此类公共数据中的第一个，而且与其他私有数据集相比也是最大的（4 倍大）[31]。此外，还提出了一种新的评估指标，以更好地平衡数据驱动方法和传统模型驱动方法。在本文中，我们提倡将所有级别特征的高级语义和低级精细细节相互交换的想法，以解决通用数据集中红外小目标和对象之间的尺度不匹配问题。为此，我们提出了一种非对称上下文调制（ACM）机制，一种可以集成到多个主机网络中的插件模块。我们的方法通过反向自下而上的上下文调制路径补充了最先进的自上而下的高级语义反馈路径，以将较小尺度的视觉细节编码到更深层，我们认为这是关键为红外小目标实现更好性能的成分

此外，高级和低级特征之间的这种相互调制是以不对称的方式实现的，其中自上而下的调制是通过传统的全局通道注意力调制（GCAM）[18]来实现的，以传播高级大规模语义信息下到浅层，而自下而上的调制是通过逐像素通道注意调制 (PCAM) 来实现的，以保留和突出高级特征中的红外小目标。我们提出的 PCAM 背后的想法是，尺度并不是空间注意力所独有的，通道注意力也可以通过改变空间池大小在多个尺度上实现。对于红外小目标，建议的 PCAM 非常适合其小尺寸。通过用提出的 ACM 模块替换现有的跨层特征融合操作，我们可以构建新的网络，其性能明显优于原始主机网络，而只需少量附加参数。关于不同调制方案影响的消融研究表明了所提出的 ACM 模块的有效性。在所提出的 SIRST 数据集上的实验表明，与其他最先进的方法相比，基于所提出的 ACM 模块的网络实现了红外小目标的最佳检测性能。

为了准确的对象定位和分割，最先进的网络遵循从粗到细的策略，将来自较低层的细微特征和来自较高层的粗略语义特征分层组合，例如，U-Net [27] 9877和特征金字塔网络（FPN）[22]。然而，大多数工作都集中在构建复杂的路径以跨层桥接特征[12]。特征融合方法本身通常是通过简单的线性方法来实现的，无论是求和还是连接，它不能为网络提供从较低层动态选择相关特征的能力。最近，已经提出了一些方法 [18, 35] 使用高级特征作为指导，通过全局通道注意模块 [15] 在长跳跃连接中调制低级特征。请注意，所提出的 ACM 模块遵循跨层调制的思想，但在两个重要方面有所不同：1）我们的 ACM 模块不是单向自上而下的路径，而是在两个方面交换高级语义和精细细节定向自上而下和自下而上的调制路径。 2）自下而上调制路径的逐点通道注意模块用于保留和突出红外小目标的细微细节。

与基于光学图像数据集的计算机视觉任务 [28, 23] 不同，红外小目标检测由于多种复杂原因长期受到数据稀缺的困扰。大多数算法都是在由非常有限的图像[31]组成的私有数据集上评估的，这很容易使性能比较不公平和不准确。一些机器学习方法利用 OSU Thermal Pedestrian [6] 等序列数据集进行训练和测试。然而，这些数据集中的目标不是小目标，不仅不符合SPIE定义[34]，也不符合红外小目标检测的典型应用场景。此外，顺序数据集不适用于单帧检测任务，因为测试集不应与训练集和验证集重叠。相比之下，我们提出的 SIRST 数据集是第一个通过仅从序列中选择一个代表性图像来显式构建开放单帧数据集的数据集。此外，这些图像用五种不同的形式进行注释，以支持对不同配方的检测任务进行建模。受限于红外数据采集（中波长或短波长）的困难，据我们所知，SIRST 不仅是第一个公开的，而且与其他私有数据集相比也是最大的 [31]

我们贡献 SIRST 的动机是连接数据驱动深度学习的最新进展和模型驱动方法占主导地位的红外小目标检测领域 [40]。为此，我们不仅将 SIRST 作为数据集，而且将其作为实现最先进方法和定制评估指标的工具包。

所提出的 SIRST 数据集包含 427 张图像，包括 480 个实例，大致分为 50% 的训练、20% 的验证和 30% 的测试。为了避免训练集、验证集和测试集之间的重叠，我们只从每个红外序列中选择一个代表图像。由于红外序列的稀缺性，除了短波和中波红外图像，SIRST 还包括 950 nm 波长的红外图像。图 1 显示了一些具有代表性的图像，从中我们可以看到许多目标非常暗淡，并且被埋在复杂的背景中，并且杂乱无章。即使对人类来说，检测它们也不是一件容易的事，这需要对整体场景的高级语义理解和集中搜索。与通用数据集中的目标检测不同，红外小目标检测是一个离群点检测问题，它是一个二元决策。由于目标太小，缺乏内在特征，所以将它们都归为一类，而不再进一步区分它们的具体类别。我们为图像提供五种注释以支持图像分类、实例分割、边界框回归、语义分割和实例定位。注释流程如图 2 所示。通过观察其在序列中的移动来确认每个目标，以确保它是真正的目标，而不是像素级脉冲噪声

每幅图像的目标数量分布如图 3(a) 所示。它表明大约 90% 的图像只包含一个目标。这一事实支持许多模型驱动的方法，将检测任务转换为寻找最稀疏或最显着的目标 [10, 33]。然而，应该注意的是，大约 10% 的图像仍然包含在这种全局唯一假设下会被忽略的额外目标。目标尺寸比例分布如图 3(b) 所示，其中约 55% 的目标仅占图像面积的 0.02%。给定一张 300×300 的图像，目标只有 3×3 像素。一般来说，检测较小的物体需要更多的上下文信息，而红外小目标由于对比度低和背景杂乱，将这一难度推到了极致。因此，在设计 CNN 时，首要任务应该是保留和突出深层红外小目标的特征。图 3(c) 给出了百分等级的目标亮度分布。请注意，只有 35% 的目标是图像中最亮的。因此，选择图像中最亮的像素并不是一个好主意，导致检测率为 0.35，误报率为 65%。作为比较，本文提出的方法可以实现 0.84 的检测率，误报率为 0.0065%，比它小 10,000 倍。考虑到 65% 的目标与背景的亮度非常相似甚至更暗，我们应该三思而后行的目标显着性假设

在将深度学习与红外小目标连接起来时，评估指标也是一个问题。一方面，开发了诸如背景抑制因子或信杂比增益等传统指标，用于过滤方法来测量目标周围的背景残差。然而，深度网络输出一个二进制掩码，在大多数情况下，这些指标的值将是无穷大。另一方面，传统方法倾向于将红外小目标检测建模为一个分割过程[10]，但牺牲分割目标的完整性以获得更高的检测率[4]，与为语义分割

为了促进可重复的研究，除了带注释的数据集，SIRST 还是一个开放工具包，提供数据处理实用程序、通用模型组件、损失函数和专门为红外小目标检测设计的评估指标。在这些模块化 API 的基础上，SIRST 提供了具有训练模型的最先进网络的实现。对于模型驱动的方法，具有最佳超参数设置的模型也提供了不损害最终性能的加速方案 [4]。基于这个开放的工具包，我们为所选方法构建了一个排行榜，作为公平比较的地方。通过它，我们希望为红外小目标检测探索正确的发展方向。

非对称上下文调制我们现在提出ACM模块和相应的网络来应对挑战：
1）如何构建深度模型来检测缺乏内在信息的红外小目标； 
2）如何在不压倒目标更精细细节的情况下对高级上下文信息进行编码。
 4.1。重新思考自上而下的注意调制给定一个低级特征 X 和一个高级特征 Y 都有 C 个通道和大小为 H × W 的特征图，自上而下的注意力调制 [18] 可以表示为 X′ = G (Y) ⊗X = σ (B(W2δ (B(W1y)))) ⊗X, 其中 y 是全局平均池化得到的全局特征上下文 y = 1 H×W ∑H,W i =1,j=1Y[:,i,j]。 δ、B、σ、⊗分别表示整流线性单元 (ReLU) [24]、批量归一化 (BN) [16]、Sigmoid 函数和逐元素乘法。 W1 ∈RC r ×C 和 W2 ∈RC×C r 是两个全连接层。 r 是通道缩减率。图 4（a）所示的这种自上而下的调制暗示了两个假设：1）高级特征提供有关目标的更准确的语义信息； 2) 全局信道上下文是一个合格的调制信号。然而，随着网络的深入，这两个假设对于红外小目标并不一定成立，因为在高级特征中，小目标很容易被背景淹没，并且它们的特征在全局平均池中也被削弱了。尽管通过自上而下调制嵌入的语义信息可以帮助处理歧义，但前提是仍然保留小目标
 4.2.自下而上的逐点注意调制为了突出深层红外小目标的细微细节，我们提出了逐点通道注意调制模块，其中每个空间位置的通道特征上下文是单独聚合的。与自顶向下调制相反，这种调制路径以自底向上的方式传播上下文信息，以利用低级特征的空间细节丰富高级特征


FPN 和Unet例子
遵循该领域的主要实践 [10, 33]，我们将红外小目标检测建模为语义分割问题。为了展示所提出的 ACM 模块的通用性和模块化，我们选择 FPN [22] 和 U-Net [27] 作为主机网络。通过用提出的 ACM 模块替换原来的跨层特征融合操作，例如 FPN 中的添加或 U-Net 中的连接，我们可以构建新的网络，即 ACM-FPN 和 ACM-U-Net 用于任务红外小目标检测，如图6所示。我们使用ResNet-20 [14]作为主干架构，如表1所示，其中我们按深度缩放模型（每个阶段的块数b ) 研究性能和网络深度之间的关系。只有当 b = 3 时，它才是 ResNet-20 的标准主干。需要注意的是，为了保留小目标，我们专门为此任务调整了下采样方案。在表 1 中，子采样仅在 Stage-2 和 Stage-3 的第一个卷积层进行

实验：
1. Q1：我们将研究调整网络下采样方案的影响，以表明在设计用于红外小目标检测的网络时，保留深层小目标是优先事项。
2.  Q2：本文的一个主要贡献是对自下而上调制路径的补充，使网络能够以双向方式交换低级和高级信息。我们将研究在相同的参数预算和逐点通道注意力的情况下，双向调制是否可以优于自上而下的调制方案。
3.   Q3：我们的另一个贡献是不对称调制，其中自上而下和自下而上的调制分别通过全局通道注意和逐点通道注意实现。它提出了一个问题，这种不对称调制有多重要？它会优于其他对称方案吗？ 
4.   Q4：最后，我们将分析基于所提出的 ACM 模块的网络与其他模型驱动方法和基线网络的比较，见第

消融实验：
下采样方案的影响：首先，我们通过比较表 1 中的调整方案和 [14] 中特征图被下采样四倍的常规方案来研究下采样方案的影响。比较结果如表 2 所示。可以看出，基于 ACM 的网络的性能明显优于基于 Regular-ACM 的网络，尤其是随着网络的深入。结果表明，红外小目标检测需要定制网络下采样方案。否则，过度的下采样会导致深层小目标特征的丢失。双向注意调制的影响：在这一部分中，我们将单向自上而下调制模块，即图 7（a）所示的 TopDownLocal 与双向调制模块，即 BiLocal 进行比较如图7（b）所示。为了保持比较的公平性，我们保持两者的逐点通道注意力的参数预算相同，即 C2。从表 2 可以看出，BiLocal 总是比 TopDown-Local 表现更好，这表明使用双向注意力调制更好，而不是仅使用自上而下调制。我们相信这种性能提升来自通过提出的自下而上调制路径嵌入高级特征中的低级精细细节，这有助于在深层保留小目标